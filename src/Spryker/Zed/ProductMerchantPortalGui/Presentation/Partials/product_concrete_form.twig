{#{% form_theme form '@ZedUi/Form/form-webcomponent-layout.twig' %}#}

{% macro langIcon(localeName) -%}
    {%- if localeName == 'en_US' -%}united-states
    {%- elseif localeName == 'de_DE' -%}germany
    {%- endif -%}
{% endmacro %}

{% block body %}
    {% set mainClass = 'mp-edit-abstract-product' %}
    {% set productData = {
        name: productConcreteName,
        sku: productConcrete.sku,
    } %}

    {% block editProduct %}

        <web-mp-edit-abstract-product product="{{ productData | json_encode() }}" cloak>
            {{ form_start(form, {attr: {excludeFormTag: true}}) }}

            {% block action %}
                <web-spy-button size="lg" type="submit" action>{{ 'Save' | trans }}</web-spy-button>
            {% endblock %}

            <web-spy-card spy-title="{{ 'Name & Description' | trans }}" class="{{ mainClass }}__card">
                {% block descriptionCardInner %}
                    {% for localizedAttributeForm in form.productConcrete.children.localizedAttributes.children %}
                        <web-spy-collapsible
                            cloak
                            class="{{ mainClass }}__collapsible"
                            title-icon="{{ _self.langIcon(localizedAttributeForm.vars.value.locale.localeName) }}"
                            spy-title="{{ localizedAttributeForm.vars.value.locale.localeName }}"
                            active="true"
                        >
                        {{ form_row(localizedAttributeForm.children.name) }}
                        {{ form_row(localizedAttributeForm.children.description) }}
                        </web-spy-collapsible>
                    {% endfor %}
                {% endblock %}
            </web-spy-card>

            <web-spy-card spy-title="{{ "Status" | trans }}">
                {{ form_row(form.productConcrete.children.isActive, {label: false, row_attr: {'no-spaces': 'true'}}) }}
            </web-spy-card>
            {% do form.useAbstractProductPrices.setRendered %}

            {{ form_end(form) }}
        </web-mp-edit-abstract-product>
    {% endblock %}
{% endblock %}
